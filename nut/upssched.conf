# === System files ===
CMDSCRIPT /etc/nut/upssched-cmd
PIPEFN /var/run/nut/upssched.pipe
LOCKFN /var/run/nut/upssched.lock

# === UPS on battery events ===
# Wait 30 seconds before notifying (avoids false alarms for micro-interruptions)
AT ONBATT * START-TIMER onbatt 30
AT ONLINE * CANCEL-TIMER onbatt onbatt-resolved

# If power returns within 30 sec, notify that everything is OK
AT ONLINE * START-TIMER onbatt-resolved 5

# === Low battery - immediate action ===
AT LOWBATT * START-TIMER lowbatt-shutdown 15
AT ONLINE * CANCEL-TIMER lowbatt-shutdown

# === Communication problems ===
# Wait 60 seconds before alarming
AT COMMBAD * START-TIMER commbad 60
AT COMMOK * CANCEL-TIMER commbad commok

# === Battery needs replacement ===
AT REPLBATT * EXECUTE replbatt

# === Forced shutdown ===
AT FSD * EXECUTE forced-shutdown

# === Battery test ===
AT NOCOMM * START-TIMER nocomm 30
AT COMMOK * CANCEL-TIMER nocomm
